(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function(){e.init()}));const e={init:function(){this.holder=document.querySelectorAll(".qi-block-google-map"),this.holder.length&&[...this.holder].map((t=>{e.initItem(t)}))},getRealCurrentItem:function(e){return"string"==typeof e&&""!==e&&(e=qiBlocksEditor.qodefGetCurrentBlockElement.get(e)),e},initItem:function(t){(t=e.getRealCurrentItem(t))&&t.classList.contains("qodef--has-key")&&"object"==typeof google&&e.initMap(t.querySelector(".qodef-m-map"))},initMap:function(e){const t=this.getMapOptions(e),o=new google.maps.Map(e,this.getMapSettings(t));this.setAddress(o,t)},getMapOptions:function(e){let t={addresses:[],addressesLatLng:[],pin:"",mapHeight:0,mapZoom:14,mapStyle:""};return e.getAttribute("data-addresses")&&(t.addresses=e.getAttribute("data-addresses").split("|")),!1!==e.getAttribute("data-pin")&&(t.pin=e.getAttribute("data-pin")),e.getAttribute("data-height")&&(t.mapHeight=parseInt(e.getAttribute("data-height"),10)),e.getAttribute("data-zoom")&&(t.mapZoom=parseInt(e.getAttribute("data-zoom"),10)),e.getAttribute("data-style")&&(t.mapStyle=e.getAttribute("data-style")),t.streetView="yes"===e.getAttribute("data-map-street-view"),t.mapTypeControl="yes"===e.getAttribute("data-map-type"),t.fullScreenControl="yes"===e.getAttribute("data-map-full-screen"),t.mapDrag="yes"===e.getAttribute("data-map-drag"),t.mapScroll="yes"===e.getAttribute("data-map-scroll"),t},getMapSettings:function(e){return{styles:e.mapStyle?JSON.parse(e.mapStyle):"",mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:e.mapScroll,draggable:e.mapDrag,streetViewControl:e.streetView,zoom:parseInt(e.mapZoom,10),mapTypeControl:e.mapTypeControl,fullscreenControl:e.fullScreenControl}},setAddress:function(e,t){for(let o=0;o<t.addresses.length;o++){const s=t.addresses[o];if(""===s)return;setTimeout((()=>{this.setSingleAddress(e,t,s,o===t.addresses.length-1)}),1e3*o)}},setSingleAddress:function(t,o,s,n){const a=new google.maps.InfoWindow({content:'<div id="content"><div id="siteNotice"></div><div id="bodyContent"><p>'+s+"</p></div></div>"}),i=new google.maps.Geocoder;"object"==typeof i&&i.geocode({address:s},(function(i,r){if(r===google.maps.GeocoderStatus.OK&&"object"==typeof i){const e=new google.maps.Marker({map:t,position:i[0].geometry.location,icon:o.pin,title:s.store_title});google.maps.event.addListener(e,"click",(function(){a.open(t,e)}));const n={address:i[0].formatted_address,latitude:i[0].geometry.location.lat(),longitude:i[0].geometry.location.lng()};o.addressesLatLng.push(n)}n&&e.centerMapAddress(t,o,i)}))},centerMapAddress:function(t,o,s){1===o.addresses.length?"object"==typeof s&&s&&t.setCenter(s[0].geometry.location):this.centerMapMultipleAddresses(t,o),google.maps.event.addDomListener(window,"resize",(function(){e.centerMapAddress(t,o,s)}))},centerMapMultipleAddresses:function(e,t){const o=new google.maps.LatLngBounds,s=t.addressesLatLng;if("object"==typeof o&&s&&s.length){for(let e=0;e<s.length;e++)o.extend({lat:parseFloat(s[e].latitude),lng:parseFloat(s[e].longitude)});e.fitBounds(o)}}}})();